{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "# CISA Known Exploited Vulnerabilities Workbook\n<p align=\"center\">\n<img src=\"https://upload.wikimedia.org/wikipedia/commons/6/6d/Seal_of_Cybersecurity_and_Infrastructure_Security_Agency.svg\" alt=\"logo\" style=\"width:200px\"></a>\n</p>\nFor the benefit of the cybersecurity community and network defenders—and to help every organization better manage vulnerabilities and keep pace with threat activity—CISA maintains the authoritative source of vulnerabilities that have been exploited in the wild. Organizations should use the KEV catalog as an input to their vulnerability management prioritization framework."
      },
      "customWidth": "33",
      "name": "text - 2"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let vulnerabilities = externaldata(cveID:string,vendorProject:string,product:string,vulnerabilityName:string,dateAdded:datetime , shortDescription:string,requiredAction:string, dueDate:datetime ,knownRansomwareCampaignUse:string,notes:string) [@\"https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\nvulnerabilities\n| where isnotempty(cveID)\n| summarize count()",
        "size": 3,
        "title": "Total Vulnerabilities",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "tiles",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "count_",
            "formatter": 12,
            "formatOptions": {
              "palette": "blue"
            }
          },
          "showBorder": false
        }
      },
      "customWidth": "15",
      "name": "query - 2 - Copy"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let vulnerabilities = externaldata(cveID:string,vendorProject:string,product:string,vulnerabilityName:string,dateAdded:datetime , shortDescription:string,requiredAction:string, dueDate:datetime ,knownRansomwareCampaignUse:string,notes:string) [@\"https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\nvulnerabilities\n| where isnotempty(cveID)\n| summarize count() by vendorProject\n| order by count_ desc\n| limit 10",
        "size": 3,
        "title": "Total Vulnerabilities by Vendor",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "tiles",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "count_",
            "formatter": 12,
            "formatOptions": {
              "palette": "blue"
            }
          },
          "subtitleContent": {
            "columnMatch": "vendorProject"
          },
          "showBorder": false
        }
      },
      "customWidth": "25",
      "name": "query - 2 - Copy - Copy"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let vulnerabilities = externaldata(cveID:string,vendorProject:string,product:string,vulnerabilityName:string,dateAdded:datetime , shortDescription:string,requiredAction:string, dueDate:datetime ,knownRansomwareCampaignUse:string,notes:string) [@\"https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\nvulnerabilities\n| where isnotempty(cveID)\n| summarize count() by product",
        "size": 3,
        "title": "Total Vulnerabilities by Product",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "piechart",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "count_",
            "formatter": 12,
            "formatOptions": {
              "palette": "blue"
            }
          },
          "showBorder": false
        },
        "chartSettings": {
          "seriesLabelSettings": [
            {
              "seriesName": "Other",
              "color": "blueDark"
            },
            {
              "seriesName": "Windows",
              "color": "blue"
            },
            {
              "seriesName": "Multiple Products",
              "color": "lightBlue"
            },
            {
              "seriesName": "Internet Explorer",
              "color": "grayBlue"
            },
            {
              "seriesName": "Flash Player",
              "color": "orangeDark"
            },
            {
              "seriesName": "Chromium V8",
              "color": "redBright"
            }
          ]
        }
      },
      "customWidth": "25",
      "name": "query - 2 - Copy - Copy - Copy"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let vulnerabilities = externaldata(cveID:string,vendorProject:string,product:string,vulnerabilityName:string,dateAdded:datetime , shortDescription:string,requiredAction:string, dueDate:datetime ,knownRansomwareCampaignUse:string,notes:string) [@\"https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\nvulnerabilities\n| where isnotempty(cveID)\n| summarize count() by knownRansomwareCampaignUse",
        "size": 3,
        "title": "Total Vulnerabilities by known Ransomware Campaign Use",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "piechart",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "count_",
            "formatter": 12,
            "formatOptions": {
              "palette": "blue"
            }
          },
          "showBorder": false
        },
        "chartSettings": {
          "seriesLabelSettings": [
            {
              "seriesName": "Unknown",
              "color": "grayBlue"
            },
            {
              "seriesName": "Known",
              "color": "green"
            }
          ]
        }
      },
      "customWidth": "30",
      "name": "query - 2 - Copy - Copy - Copy - Copy"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let vulnerabilities = externaldata(cveID:string,vendorProject:string,product:string,vulnerabilityName:string,dateAdded:datetime , shortDescription:string,requiredAction:string, dueDate:datetime ,knownRansomwareCampaignUse:string,notes:string) [@\"https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\nvulnerabilities\n| where isnotempty(cveID)\n| summarize count() by bin(dateAdded,1d)",
        "size": 0,
        "title": "Total Vulnerabilities Count Overtime",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "barchart",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "count_",
            "formatter": 12,
            "formatOptions": {
              "palette": "blue"
            }
          },
          "showBorder": false
        }
      },
      "customWidth": "65",
      "name": "query - 2 - Copy - Copy - Copy - Copy - Copy"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "dd3b9a34-ff51-4e86-a3cf-bde05ded1ca1",
            "version": "KqlParameterItem/1.0",
            "name": "Search",
            "type": 1,
            "timeContext": {
              "durationMs": 86400000
            },
            "value": ""
          }
        ],
        "style": "above",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - 7"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let vulnerabilities = externaldata(cveID:string,vendorProject:string,product:string,vulnerabilityName:string,dateAdded:datetime , shortDescription:string,requiredAction:string, dueDate:datetime ,knownRansomwareCampaignUse:string,notes:string) [@\"https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv\"] with (format=\"csv\", ignoreFirstRecord=True);\nvulnerabilities\n| where isnotempty(cveID)\n| where cveID contains \"{Search}\"",
        "size": 0,
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "cveID",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "icons",
                "thresholdsGrid": [
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "3",
                    "text": "{0}{1}"
                  }
                ]
              }
            }
          ]
        }
      },
      "name": "query - 2"
    }
  ],
  "fallbackResourceIds": [
    ""
  ],
  "fromTemplateId": "sentinel-UserWorkbook",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
